(self.webpackChunkbangumi_app=self.webpackChunkbangumi_app||[]).push([[4345],{"./node_modules/.pnpm/@heroicons+react@2.0.16_react@18.2.0/node_modules/@heroicons/react/20/solid/BookmarkIcon.js":(module,__unused_webpack_exports,__webpack_require__)=>{const React=__webpack_require__("./node_modules/.pnpm/react@18.2.0/node_modules/react/index.js");const ForwardRef=React.forwardRef((function BookmarkIcon({title,titleId,...props},svgRef){return React.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:svgRef,"aria-labelledby":titleId},props),title?React.createElement("title",{id:titleId},title):null,React.createElement("path",{fillRule:"evenodd",d:"M10 2c-1.716 0-3.408.106-5.07.31C3.806 2.45 3 3.414 3 4.517V17.25a.75.75 0 001.075.676L10 15.082l5.925 2.844A.75.75 0 0017 17.25V4.517c0-1.103-.806-2.068-1.93-2.207A41.403 41.403 0 0010 2z",clipRule:"evenodd"}))}));module.exports=ForwardRef},"./components/Card/CollectionCard.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{CollectionCard_:()=>CollectionCard_,default:()=>CollectionCard_stories});var react=__webpack_require__("./node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),next_image=__webpack_require__("./node_modules/.pnpm/next@13.2.4_hrdbe576m4w26u2yfpqpvbxyky/node_modules/next/image.js"),image_default=__webpack_require__.n(next_image),esm_extends=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.21.0/node_modules/@babel/runtime/helpers/esm/extends.js"),slicedToArray=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.21.0/node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),objectWithoutProperties=__webpack_require__("./node_modules/.pnpm/@babel+runtime@7.21.0/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js"),InformationCircleIcon=__webpack_require__("./node_modules/.pnpm/@heroicons+react@2.0.16_react@18.2.0/node_modules/@heroicons/react/24/outline/InformationCircleIcon.js"),panel=__webpack_require__("./lib/panel.ts"),utils=__webpack_require__("./node_modules/.pnpm/jotai@2.0.3_react@18.2.0/node_modules/jotai/esm/react/utils.mjs"),Button=__webpack_require__("./ui/primitive/Button.tsx"),Tooltip=__webpack_require__("./ui/primitive/Tooltip.tsx"),esm_react=__webpack_require__("./node_modules/.pnpm/jotai@2.0.3_react@18.2.0/node_modules/jotai/esm/react.mjs"),vanilla=__webpack_require__("./node_modules/.pnpm/jotai@2.0.3_react@18.2.0/node_modules/jotai/esm/vanilla.mjs"),__jsx=react.createElement,rootStore=(0,vanilla.MT)();function JotaiProvider(_ref){var children=_ref.children;return __jsx(esm_react.zt,{store:rootStore},children)}JotaiProvider.displayName="JotaiProvider",JotaiProvider.__docgenInfo={description:"",methods:[],displayName:"JotaiProvider",props:{children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}};try{JotaiProvider.displayName="JotaiProvider",JotaiProvider.__docgenInfo={description:"",displayName:"JotaiProvider",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["components/Provider/JotaiProvider.tsx#JotaiProvider"]={docgenInfo:JotaiProvider.__docgenInfo,name:"JotaiProvider",path:"components/Provider/JotaiProvider.tsx#JotaiProvider"})}catch(__react_docgen_typescript_loader_error){}var _excluded=["subject_id"],InfoButton_jsx=react.createElement,InfoButton_=(0,react.forwardRef)((function(_ref,ref){var subject_id=_ref.subject_id,props=(0,objectWithoutProperties.Z)(_ref,_excluded),_useReducerAtom=(0,utils.w4)(panel.Xk,panel.UE),dispatch=(0,slicedToArray.Z)(_useReducerAtom,2)[1];return InfoButton_jsx(Tooltip.u,{content:"显示详情"},InfoButton_jsx(Button.z,(0,esm_extends.Z)({ref,variant:{type:"primary",color:"accent",iconOnly:!0},onClick:function onClick(){dispatch({type:"push",value:{type:"subject",target_id:Number(subject_id)}})},"aria-label":"open-info-panel"},props),InfoButton_jsx(InformationCircleIcon,{className:"h-6 w-6"})))}));InfoButton_.displayName="InfoButton";var InfoButton=(0,react.forwardRef)((function(props,ref){return InfoButton_jsx(esm_react.zt,{store:rootStore},InfoButton_jsx(InfoButton_,(0,esm_extends.Z)({},props,{ref})))}));InfoButton.displayName="InfoButton",InfoButton.__docgenInfo={description:"",methods:[],displayName:"InfoButton"};try{InfoButton.displayName="InfoButton",InfoButton.__docgenInfo={description:"",displayName:"InfoButton",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},subject_id:{defaultValue:null,description:"",name:"subject_id",required:!0,type:{name:"number"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["components/Button/InfoButton.tsx#InfoButton"]={docgenInfo:InfoButton.__docgenInfo,name:"InfoButton",path:"components/Button/InfoButton.tsx#InfoButton"})}catch(__react_docgen_typescript_loader_error){}var CalendarDaysIcon=__webpack_require__("./node_modules/.pnpm/@heroicons+react@2.0.16_react@18.2.0/node_modules/@heroicons/react/20/solid/CalendarDaysIcon.js"),TableCellsIcon=__webpack_require__("./node_modules/.pnpm/@heroicons+react@2.0.16_react@18.2.0/node_modules/@heroicons/react/20/solid/TableCellsIcon.js"),BookmarkIcon=__webpack_require__("./node_modules/.pnpm/@heroicons+react@2.0.16_react@18.2.0/node_modules/@heroicons/react/20/solid/BookmarkIcon.js"),Rating=__webpack_require__("./components/Rating/Rating.tsx"),Card=__webpack_require__("./ui/primitive/Card.tsx"),lib_utils=__webpack_require__("./lib/utils.ts"),Dialog=__webpack_require__("./ui/primitive/Dialog.tsx"),CardComment_jsx=react.createElement;function CardComment(_ref){var comment=_ref.comment,_useState=(0,react.useState)(!1),isClamped=_useState[0],setIsClamped=_useState[1],commentRef=(0,react.useRef)(null);return(0,react.useEffect)((function(){commentRef.current&&setIsClamped(commentRef.current.scrollHeight>commentRef.current.clientHeight+1)}),[]),CardComment_jsx(Dialog.Vq,null,CardComment_jsx(Dialog.hg,{asChild:!0},CardComment_jsx("div",{ref:commentRef,className:(0,lib_utils.cn)("whitespace-pre-wrap text-xs font-medium italic text-accent-12 line-clamp-1",isClamped&&"hover:cursor-pointer hover:not-italic")},"“ ",comment," ”")),CardComment_jsx(Dialog.cZ,null,CardComment_jsx(Dialog.dP,null,CardComment_jsx(Dialog.$N,null,"评论")),CardComment_jsx(Dialog.Be,null,comment)))}CardComment.displayName="CardComment",CardComment.__docgenInfo={description:"",methods:[],displayName:"CardComment",props:{comment:{required:!0,tsType:{name:"string"},description:""}}};try{CardComment.displayName="CardComment",CardComment.__docgenInfo={description:"",displayName:"CardComment",props:{comment:{defaultValue:null,description:"",name:"comment",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["components/Dialog/CardComment.tsx#CardComment"]={docgenInfo:CardComment.__docgenInfo,name:"CardComment",path:"components/Dialog/CardComment.tsx#CardComment"})}catch(__react_docgen_typescript_loader_error){}var ChatBubbleLeftRightIcon=__webpack_require__("./node_modules/.pnpm/@heroicons+react@2.0.16_react@18.2.0/node_modules/@heroicons/react/24/outline/ChatBubbleLeftRightIcon.js"),use_toast=__webpack_require__("./hooks/use-toast.ts"),ChatButton_excluded=["subject_id"],ChatButton_jsx=react.createElement,ChatButton_=(0,react.forwardRef)((function(_ref,ref){_ref.subject_id;var props=(0,objectWithoutProperties.Z)(_ref,ChatButton_excluded),toast=(0,use_toast.p)();return ChatButton_jsx(Tooltip.u,{content:"显示讨论"},ChatButton_jsx(Button.z,(0,esm_extends.Z)({variant:{type:"primary",color:"accent",iconOnly:!0},ref,onClick:function onClick(){toast({type:"info",title:"功能尚未实现！"})},"aria-label":"open-chat-panel"},props),ChatButton_jsx(ChatBubbleLeftRightIcon,{className:"h-6 w-6"})))}));ChatButton_.displayName="ChatButton";var ChatButton=(0,react.forwardRef)((function(props,ref){return ChatButton_jsx(esm_react.zt,{store:rootStore},ChatButton_jsx(ChatButton_,(0,esm_extends.Z)({},props,{ref})))}));ChatButton.displayName="ChatButton",ChatButton_.__docgenInfo={description:"",methods:[],displayName:"ChatButton"},ChatButton.__docgenInfo={description:"",methods:[],displayName:"ChatButton"};try{ChatButton_.displayName="ChatButton",ChatButton_.__docgenInfo={description:"",displayName:"ChatButton",props:{subject_id:{defaultValue:null,description:"",name:"subject_id",required:!0,type:{name:"number"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["components/Button/ChatButton.tsx#ChatButton"]={docgenInfo:ChatButton.__docgenInfo,name:"ChatButton",path:"components/Button/ChatButton.tsx#ChatButton"})}catch(__react_docgen_typescript_loader_error){}var Badge=__webpack_require__("./ui/primitive/Badge.tsx"),CollectionCard_jsx=react.createElement;function CollectionCard(_ref){var collection=_ref.collection,_ref$pvMode=_ref.pvMode,pvMode=void 0!==_ref$pvMode&&_ref$pvMode;return CollectionCard_jsx(Card.Zb,null,CollectionCard_jsx(Card.xu,null,CollectionCard_jsx(image_default(),{className:"object-cover",src:collection.subject.images.common,fill:!0,unoptimized:!0,alt:"card-image"})),CollectionCard_jsx(Card.eW,null,CollectionCard_jsx(Card.Ol,null,CollectionCard_jsx(Card.ll,{mainTitle:collection.subject.name_cn||collection.subject.name,subTitle:collection.subject.name}),CollectionCard_jsx(Card.vz,null,CollectionCard_jsx(InfoButton,{subject_id:collection.subject.id}),CollectionCard_jsx(ChatButton,{subject_id:collection.subject.id}))),CollectionCard_jsx(Card.tg,null,CollectionCard_jsx(Card.cq,null,CollectionCard_jsx("span",{className:"h-4 w-4"},CollectionCard_jsx(CalendarDaysIcon,null)),CollectionCard_jsx("span",null,collection.subject.date)),CollectionCard_jsx(Card.cq,null,CollectionCard_jsx("span",{className:"h-4 w-4"},CollectionCard_jsx(TableCellsIcon,null)),CollectionCard_jsx("span",null,collection.subject.eps?"".concat(collection.ep_status," / ").concat(collection.subject.eps," 集"):"未知")),CollectionCard_jsx(Card.cq,null,CollectionCard_jsx("span",{className:"h-4 w-4"},CollectionCard_jsx(BookmarkIcon,null)),CollectionCard_jsx("span",null,collection.subject.collection_total," 人收藏"))),CollectionCard_jsx(Card.GK,null,pvMode?collection.tags.map((function(tag){return CollectionCard_jsx(Badge.C,{variant:{color:"primary"},key:tag},tag)})):collection.subject.tags.map((function(tag){return CollectionCard_jsx(Badge.C,{variant:{color:"primary"},key:tag.name},tag.name)}))),CollectionCard_jsx(Card.iR,null,CollectionCard_jsx("div",{className:"h-10 text-4xl font-bold text-accent-11"},pvMode?collection.rate||null:collection.subject.score.toFixed(1)),CollectionCard_jsx("div",{className:"flex flex-col justify-center space-y-1"},CollectionCard_jsx("div",null,CollectionCard_jsx(Rating.i,{score:pvMode?collection.rate:collection.subject.score})),collection.comment?CollectionCard_jsx(CardComment,{comment:collection.comment}):CollectionCard_jsx("span",{className:"text-xs text-neutral-11"},"未发表吐槽")))))}CollectionCard.displayName="CollectionCard",CollectionCard.__docgenInfo={description:"",methods:[],displayName:"CollectionCard",props:{pvMode:{defaultValue:{value:"false",computed:!1},required:!1,tsType:{name:"boolean"},description:""},collection:{required:!0,tsType:{name:'z.infer["data"][number]',raw:'z.infer<typeof collectionsPageScheme>["data"][number]'},description:""}}};try{CollectionCard.displayName="CollectionCard",CollectionCard.__docgenInfo={description:"",displayName:"CollectionCard",props:{collection:{defaultValue:null,description:"",name:"collection",required:!0,type:{name:"{ tags: string[]; subject: { name: string; tags: { name: string; count: number; }[]; score: number; id: number; name_cn: string; date: string; eps: number; images: { medium: string; large: string; common: string; }; type: number; collection_total: number; }; ... 7 more ...; private: boolean; }"}},pvMode:{defaultValue:{value:"false"},description:"",name:"pvMode",required:!1,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["components/Card/CollectionCard.tsx#CollectionCard"]={docgenInfo:CollectionCard.__docgenInfo,name:"CollectionCard",path:"components/Card/CollectionCard.tsx#CollectionCard"})}catch(__react_docgen_typescript_loader_error){}var collection=__webpack_require__("./lib/api/collection.ts"),StorybookDecorator=__webpack_require__("./ui/StorybookDecorator.tsx");const CollectionCard_stories={component:CollectionCard,decorators:[StorybookDecorator.jS,StorybookDecorator.d$]};var CollectionCard_={args:{collection:collection.X9.parse({comment:null,tags:["EVA","神作","原创"],subject:{date:"1995-10-04",images:{small:"https://lain.bgm.tv/r/200/pic/cover/l/e5/69/265_Z5Uou.jpg",grid:"https://lain.bgm.tv/r/100/pic/cover/l/e5/69/265_Z5Uou.jpg",large:"https://lain.bgm.tv/pic/cover/l/e5/69/265_Z5Uou.jpg",medium:"https://lain.bgm.tv/r/800/pic/cover/l/e5/69/265_Z5Uou.jpg",common:"https://lain.bgm.tv/r/400/pic/cover/l/e5/69/265_Z5Uou.jpg"},name:"新世紀エヴァンゲリオン",name_cn:"新世纪福音战士",short_summary:"　　2000年，一个科学探险队在南极洲针对被称作“第一使徒”亚当的“光之巨人”进行探险。在对其进行接触实验时，“光之巨人”自毁，从而发生了“第二次冲击”，进而导致世界大战。最后，人类人口减半，地轴偏转、气候改变。根据对“第二次冲击”的调查，",tags:[{name:"EVA",count:6417},{name:"庵野秀明",count:4779},{name:"GAINAX",count:3202},{name:"新世纪福音战士",count:2762},{name:"神作",count:2347},{name:"科幻",count:2050},{name:"宗教",count:1456},{name:"TV",count:1444},{name:"心理",count:1092},{name:"骗钱神棍片的王者",count:935}],score:8.9,type:2,id:265,eps:26,volumes:0,collection_total:31816,rank:9},subject_id:265,vol_status:0,ep_status:24,subject_type:2,type:2,rate:9,private:!1})}};CollectionCard_.parameters={...CollectionCard_.parameters,docs:{...CollectionCard_.parameters?.docs,source:{originalSource:"{\n  args: {\n    collection: collectionsDataScheme.parse(collectionData)\n  }\n}",...CollectionCard_.parameters?.docs?.source}}}}}]);